{"ast":null,"code":"/**\r\n * DevExtreme (events/gesture/emitter.gesture.js)\r\n * Version: 18.2.13\r\n * Build date: Wed May 27 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar $ = require(\"../../core/renderer\"),\n    eventsEngine = require(\"../../events/core/events_engine\"),\n    devices = require(\"../../core/devices\"),\n    styleUtils = require(\"../../core/utils/style\"),\n    callOnce = require(\"../../core/utils/call_once\"),\n    domUtils = require(\"../../core/utils/dom\"),\n    readyCallbacks = require(\"../../core/utils/ready_callbacks\"),\n    ready = readyCallbacks.add,\n    mathUtils = require(\"../../core/utils/math\"),\n    noop = require(\"../../core/utils/common\").noop,\n    isDefined = require(\"../../core/utils/type\").isDefined,\n    eventUtils = require(\"../utils\"),\n    Emitter = require(\"../core/emitter\"),\n    sign = mathUtils.sign,\n    abs = Math.abs;\n\nvar SLEEP = 0,\n    INITED = 1,\n    STARTED = 2,\n    TOUCH_BOUNDARY = 10,\n    IMMEDIATE_TOUCH_BOUNDARY = 0,\n    IMMEDIATE_TIMEOUT = 180;\n\nvar supportPointerEvents = function () {\n  return styleUtils.styleProp(\"pointer-events\");\n};\n\nvar setGestureCover = callOnce(function () {\n  var GESTURE_COVER_CLASS = \"dx-gesture-cover\";\n  var isDesktop = \"generic\" === devices.real().platform;\n\n  if (!supportPointerEvents() || !isDesktop) {\n    return noop;\n  }\n\n  var $cover = $(\"<div>\").addClass(GESTURE_COVER_CLASS).css(\"pointerEvents\", \"none\");\n  eventsEngine.subscribeGlobal($cover, \"dxmousewheel\", function (e) {\n    e.preventDefault();\n  });\n  ready(function () {\n    $cover.appendTo(\"body\");\n  });\n  return function (toggle, cursor) {\n    $cover.css(\"pointerEvents\", toggle ? \"all\" : \"none\");\n    toggle && $cover.css(\"cursor\", cursor);\n  };\n});\n\nvar gestureCover = function (toggle, cursor) {\n  var gestureCoverStrategy = setGestureCover();\n  gestureCoverStrategy(toggle, cursor);\n};\n\nvar GestureEmitter = Emitter.inherit({\n  gesture: true,\n  configure: function (data) {\n    this.getElement().css(\"msTouchAction\", data.immediate ? \"pinch-zoom\" : \"\");\n    this.callBase(data);\n  },\n  allowInterruptionByMouseWheel: function () {\n    return this._stage !== STARTED;\n  },\n  getDirection: function () {\n    return this.direction;\n  },\n  _cancel: function () {\n    this.callBase.apply(this, arguments);\n\n    this._toggleGestureCover(false);\n\n    this._stage = SLEEP;\n  },\n  start: function (e) {\n    if (e._needSkipEvent || eventUtils.needSkipEvent(e)) {\n      this._cancel(e);\n\n      return;\n    }\n\n    this._startEvent = eventUtils.createEvent(e);\n    this._startEventData = eventUtils.eventData(e);\n    this._stage = INITED;\n\n    this._init(e);\n\n    this._setupImmediateTimer();\n  },\n  _setupImmediateTimer: function () {\n    clearTimeout(this._immediateTimer);\n    this._immediateAccepted = false;\n\n    if (!this.immediate) {\n      return;\n    }\n\n    this._immediateTimer = setTimeout(function () {\n      this._immediateAccepted = true;\n    }.bind(this), IMMEDIATE_TIMEOUT);\n  },\n  move: function (e) {\n    if (this._stage === INITED && this._directionConfirmed(e)) {\n      this._stage = STARTED;\n\n      this._resetActiveElement();\n\n      this._toggleGestureCover(true);\n\n      this._clearSelection(e);\n\n      this._adjustStartEvent(e);\n\n      this._start(this._startEvent);\n\n      if (this._stage === SLEEP) {\n        return;\n      }\n\n      this._requestAccept(e);\n\n      this._move(e);\n\n      this._forgetAccept();\n    } else {\n      if (this._stage === STARTED) {\n        this._clearSelection(e);\n\n        this._move(e);\n      }\n    }\n  },\n  _directionConfirmed: function (e) {\n    var touchBoundary = this._getTouchBoundary(e),\n        delta = eventUtils.eventDelta(this._startEventData, eventUtils.eventData(e)),\n        deltaX = abs(delta.x),\n        deltaY = abs(delta.y);\n\n    var horizontalMove = this._validateMove(touchBoundary, deltaX, deltaY),\n        verticalMove = this._validateMove(touchBoundary, deltaY, deltaX);\n\n    var direction = this.getDirection(e),\n        bothAccepted = \"both\" === direction && (horizontalMove || verticalMove),\n        horizontalAccepted = \"horizontal\" === direction && horizontalMove,\n        verticalAccepted = \"vertical\" === direction && verticalMove;\n    return bothAccepted || horizontalAccepted || verticalAccepted || this._immediateAccepted;\n  },\n  _validateMove: function (touchBoundary, mainAxis, crossAxis) {\n    return mainAxis && mainAxis >= touchBoundary && (this.immediate ? mainAxis >= crossAxis : true);\n  },\n  _getTouchBoundary: function (e) {\n    return this.immediate || eventUtils.isDxMouseWheelEvent(e) ? IMMEDIATE_TOUCH_BOUNDARY : TOUCH_BOUNDARY;\n  },\n  _adjustStartEvent: function (e) {\n    var touchBoundary = this._getTouchBoundary(e),\n        delta = eventUtils.eventDelta(this._startEventData, eventUtils.eventData(e));\n\n    this._startEvent.pageX += sign(delta.x) * touchBoundary;\n    this._startEvent.pageY += sign(delta.y) * touchBoundary;\n  },\n  _resetActiveElement: function () {\n    if (\"ios\" === devices.real().platform && this.getElement().find(\":focus\").length) {\n      domUtils.resetActiveElement();\n    }\n  },\n  _toggleGestureCover: function (toggle) {\n    var isStarted = this._stage === STARTED;\n\n    if (isStarted) {\n      gestureCover(toggle, this.getElement().css(\"cursor\"));\n    }\n  },\n  _clearSelection: function (e) {\n    if (eventUtils.isDxMouseWheelEvent(e) || eventUtils.isTouchEvent(e)) {\n      return;\n    }\n\n    domUtils.clearSelection();\n  },\n  end: function (e) {\n    this._toggleGestureCover(false);\n\n    if (this._stage === STARTED) {\n      this._end(e);\n    } else {\n      if (this._stage === INITED) {\n        this._stop(e);\n      }\n    }\n\n    this._stage = SLEEP;\n  },\n  dispose: function () {\n    clearTimeout(this._immediateTimer);\n    this.callBase.apply(this, arguments);\n\n    this._toggleGestureCover(false);\n  },\n  _init: noop,\n  _start: noop,\n  _move: noop,\n  _stop: noop,\n  _end: noop\n});\nGestureEmitter.initialTouchBoundary = TOUCH_BOUNDARY;\n\nGestureEmitter.touchBoundary = function (newBoundary) {\n  if (isDefined(newBoundary)) {\n    TOUCH_BOUNDARY = newBoundary;\n    return;\n  }\n\n  return TOUCH_BOUNDARY;\n};\n\nmodule.exports = GestureEmitter;","map":{"version":3,"sources":["C:/Users/abdel/PhpstormProjects/editeur_scenario_jeu/node_modules/devextreme/events/gesture/emitter.gesture.js"],"names":["$","require","eventsEngine","devices","styleUtils","callOnce","domUtils","readyCallbacks","ready","add","mathUtils","noop","isDefined","eventUtils","Emitter","sign","abs","Math","SLEEP","INITED","STARTED","TOUCH_BOUNDARY","IMMEDIATE_TOUCH_BOUNDARY","IMMEDIATE_TIMEOUT","supportPointerEvents","styleProp","setGestureCover","GESTURE_COVER_CLASS","isDesktop","real","platform","$cover","addClass","css","subscribeGlobal","e","preventDefault","appendTo","toggle","cursor","gestureCover","gestureCoverStrategy","GestureEmitter","inherit","gesture","configure","data","getElement","immediate","callBase","allowInterruptionByMouseWheel","_stage","getDirection","direction","_cancel","apply","arguments","_toggleGestureCover","start","_needSkipEvent","needSkipEvent","_startEvent","createEvent","_startEventData","eventData","_init","_setupImmediateTimer","clearTimeout","_immediateTimer","_immediateAccepted","setTimeout","bind","move","_directionConfirmed","_resetActiveElement","_clearSelection","_adjustStartEvent","_start","_requestAccept","_move","_forgetAccept","touchBoundary","_getTouchBoundary","delta","eventDelta","deltaX","x","deltaY","y","horizontalMove","_validateMove","verticalMove","bothAccepted","horizontalAccepted","verticalAccepted","mainAxis","crossAxis","isDxMouseWheelEvent","pageX","pageY","find","length","resetActiveElement","isStarted","isTouchEvent","clearSelection","end","_end","_stop","dispose","initialTouchBoundary","newBoundary","module","exports"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (events/gesture/emitter.gesture.js)\r\n * Version: 18.2.13\r\n * Build date: Wed May 27 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar $ = require(\"../../core/renderer\"),\r\n    eventsEngine = require(\"../../events/core/events_engine\"),\r\n    devices = require(\"../../core/devices\"),\r\n    styleUtils = require(\"../../core/utils/style\"),\r\n    callOnce = require(\"../../core/utils/call_once\"),\r\n    domUtils = require(\"../../core/utils/dom\"),\r\n    readyCallbacks = require(\"../../core/utils/ready_callbacks\"),\r\n    ready = readyCallbacks.add,\r\n    mathUtils = require(\"../../core/utils/math\"),\r\n    noop = require(\"../../core/utils/common\").noop,\r\n    isDefined = require(\"../../core/utils/type\").isDefined,\r\n    eventUtils = require(\"../utils\"),\r\n    Emitter = require(\"../core/emitter\"),\r\n    sign = mathUtils.sign,\r\n    abs = Math.abs;\r\nvar SLEEP = 0,\r\n    INITED = 1,\r\n    STARTED = 2,\r\n    TOUCH_BOUNDARY = 10,\r\n    IMMEDIATE_TOUCH_BOUNDARY = 0,\r\n    IMMEDIATE_TIMEOUT = 180;\r\nvar supportPointerEvents = function() {\r\n    return styleUtils.styleProp(\"pointer-events\")\r\n};\r\nvar setGestureCover = callOnce(function() {\r\n    var GESTURE_COVER_CLASS = \"dx-gesture-cover\";\r\n    var isDesktop = \"generic\" === devices.real().platform;\r\n    if (!supportPointerEvents() || !isDesktop) {\r\n        return noop\r\n    }\r\n    var $cover = $(\"<div>\").addClass(GESTURE_COVER_CLASS).css(\"pointerEvents\", \"none\");\r\n    eventsEngine.subscribeGlobal($cover, \"dxmousewheel\", function(e) {\r\n        e.preventDefault()\r\n    });\r\n    ready(function() {\r\n        $cover.appendTo(\"body\")\r\n    });\r\n    return function(toggle, cursor) {\r\n        $cover.css(\"pointerEvents\", toggle ? \"all\" : \"none\");\r\n        toggle && $cover.css(\"cursor\", cursor)\r\n    }\r\n});\r\nvar gestureCover = function(toggle, cursor) {\r\n    var gestureCoverStrategy = setGestureCover();\r\n    gestureCoverStrategy(toggle, cursor)\r\n};\r\nvar GestureEmitter = Emitter.inherit({\r\n    gesture: true,\r\n    configure: function(data) {\r\n        this.getElement().css(\"msTouchAction\", data.immediate ? \"pinch-zoom\" : \"\");\r\n        this.callBase(data)\r\n    },\r\n    allowInterruptionByMouseWheel: function() {\r\n        return this._stage !== STARTED\r\n    },\r\n    getDirection: function() {\r\n        return this.direction\r\n    },\r\n    _cancel: function() {\r\n        this.callBase.apply(this, arguments);\r\n        this._toggleGestureCover(false);\r\n        this._stage = SLEEP\r\n    },\r\n    start: function(e) {\r\n        if (e._needSkipEvent || eventUtils.needSkipEvent(e)) {\r\n            this._cancel(e);\r\n            return\r\n        }\r\n        this._startEvent = eventUtils.createEvent(e);\r\n        this._startEventData = eventUtils.eventData(e);\r\n        this._stage = INITED;\r\n        this._init(e);\r\n        this._setupImmediateTimer()\r\n    },\r\n    _setupImmediateTimer: function() {\r\n        clearTimeout(this._immediateTimer);\r\n        this._immediateAccepted = false;\r\n        if (!this.immediate) {\r\n            return\r\n        }\r\n        this._immediateTimer = setTimeout(function() {\r\n            this._immediateAccepted = true\r\n        }.bind(this), IMMEDIATE_TIMEOUT)\r\n    },\r\n    move: function(e) {\r\n        if (this._stage === INITED && this._directionConfirmed(e)) {\r\n            this._stage = STARTED;\r\n            this._resetActiveElement();\r\n            this._toggleGestureCover(true);\r\n            this._clearSelection(e);\r\n            this._adjustStartEvent(e);\r\n            this._start(this._startEvent);\r\n            if (this._stage === SLEEP) {\r\n                return\r\n            }\r\n            this._requestAccept(e);\r\n            this._move(e);\r\n            this._forgetAccept()\r\n        } else {\r\n            if (this._stage === STARTED) {\r\n                this._clearSelection(e);\r\n                this._move(e)\r\n            }\r\n        }\r\n    },\r\n    _directionConfirmed: function(e) {\r\n        var touchBoundary = this._getTouchBoundary(e),\r\n            delta = eventUtils.eventDelta(this._startEventData, eventUtils.eventData(e)),\r\n            deltaX = abs(delta.x),\r\n            deltaY = abs(delta.y);\r\n        var horizontalMove = this._validateMove(touchBoundary, deltaX, deltaY),\r\n            verticalMove = this._validateMove(touchBoundary, deltaY, deltaX);\r\n        var direction = this.getDirection(e),\r\n            bothAccepted = \"both\" === direction && (horizontalMove || verticalMove),\r\n            horizontalAccepted = \"horizontal\" === direction && horizontalMove,\r\n            verticalAccepted = \"vertical\" === direction && verticalMove;\r\n        return bothAccepted || horizontalAccepted || verticalAccepted || this._immediateAccepted\r\n    },\r\n    _validateMove: function(touchBoundary, mainAxis, crossAxis) {\r\n        return mainAxis && mainAxis >= touchBoundary && (this.immediate ? mainAxis >= crossAxis : true)\r\n    },\r\n    _getTouchBoundary: function(e) {\r\n        return this.immediate || eventUtils.isDxMouseWheelEvent(e) ? IMMEDIATE_TOUCH_BOUNDARY : TOUCH_BOUNDARY\r\n    },\r\n    _adjustStartEvent: function(e) {\r\n        var touchBoundary = this._getTouchBoundary(e),\r\n            delta = eventUtils.eventDelta(this._startEventData, eventUtils.eventData(e));\r\n        this._startEvent.pageX += sign(delta.x) * touchBoundary;\r\n        this._startEvent.pageY += sign(delta.y) * touchBoundary\r\n    },\r\n    _resetActiveElement: function() {\r\n        if (\"ios\" === devices.real().platform && this.getElement().find(\":focus\").length) {\r\n            domUtils.resetActiveElement()\r\n        }\r\n    },\r\n    _toggleGestureCover: function(toggle) {\r\n        var isStarted = this._stage === STARTED;\r\n        if (isStarted) {\r\n            gestureCover(toggle, this.getElement().css(\"cursor\"))\r\n        }\r\n    },\r\n    _clearSelection: function(e) {\r\n        if (eventUtils.isDxMouseWheelEvent(e) || eventUtils.isTouchEvent(e)) {\r\n            return\r\n        }\r\n        domUtils.clearSelection()\r\n    },\r\n    end: function(e) {\r\n        this._toggleGestureCover(false);\r\n        if (this._stage === STARTED) {\r\n            this._end(e)\r\n        } else {\r\n            if (this._stage === INITED) {\r\n                this._stop(e)\r\n            }\r\n        }\r\n        this._stage = SLEEP\r\n    },\r\n    dispose: function() {\r\n        clearTimeout(this._immediateTimer);\r\n        this.callBase.apply(this, arguments);\r\n        this._toggleGestureCover(false)\r\n    },\r\n    _init: noop,\r\n    _start: noop,\r\n    _move: noop,\r\n    _stop: noop,\r\n    _end: noop\r\n});\r\nGestureEmitter.initialTouchBoundary = TOUCH_BOUNDARY;\r\nGestureEmitter.touchBoundary = function(newBoundary) {\r\n    if (isDefined(newBoundary)) {\r\n        TOUCH_BOUNDARY = newBoundary;\r\n        return\r\n    }\r\n    return TOUCH_BOUNDARY\r\n};\r\nmodule.exports = GestureEmitter;\r\n"]},"metadata":{},"sourceType":"script"}