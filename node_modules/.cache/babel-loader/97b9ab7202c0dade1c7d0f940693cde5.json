{"ast":null,"code":"/**\r\n * DevExtreme (ui/widget/bindable_template.js)\r\n * Version: 18.2.13\r\n * Build date: Wed May 27 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar $ = require(\"../../core/renderer\"),\n    TemplateBase = require(\"./ui.template_base\"),\n    eventsEngine = require(\"../../events/core/events_engine\"),\n    removeEvent = require(\"../../core/remove_event\"),\n    iteratorUtils = require(\"../../core/utils/iterator\"),\n    isPrimitive = require(\"../../core/utils/type\").isPrimitive;\n\nvar watchChanges = function () {\n  var start = function (rawData, watchMethod, fields, fieldsMap, callback) {\n    var globalDispose, fieldsDispose;\n    globalDispose = globalWatch(rawData, watchMethod, function (dataWithRawFields) {\n      fieldsDispose && fieldsDispose();\n\n      if (isPrimitive(dataWithRawFields)) {\n        callback(dataWithRawFields);\n        return;\n      }\n\n      fieldsDispose = fieldsWatch(dataWithRawFields, watchMethod, fields, fieldsMap, function (data) {\n        callback(data);\n      });\n    });\n    return function () {\n      fieldsDispose && fieldsDispose();\n      globalDispose && globalDispose();\n    };\n  };\n\n  var globalWatch = function (data, watchMethod, callback) {\n    return watchMethod(function () {\n      return data;\n    }, callback);\n  };\n\n  var fieldsWatch = function (data, watchMethod, fields, fieldsMap, callback) {\n    var resolvedData = {},\n        missedFields = fields.slice();\n    var watchHandlers = iteratorUtils.map(fields, function (name) {\n      var fieldGetter = fieldsMap[name];\n      return watchMethod(fieldGetter ? function () {\n        return fieldGetter(data);\n      } : function () {\n        return data[name];\n      }, function (value) {\n        resolvedData[name] = value;\n\n        if (missedFields.length) {\n          var index = missedFields.indexOf(name);\n\n          if (index >= 0) {\n            missedFields.splice(index, 1);\n          }\n        }\n\n        if (!missedFields.length) {\n          callback(resolvedData);\n        }\n      });\n    });\n    return function () {\n      iteratorUtils.each(watchHandlers, function (_, dispose) {\n        dispose();\n      });\n    };\n  };\n\n  return start;\n}();\n\nmodule.exports = TemplateBase.inherit({\n  ctor: function (render, fields, watchMethod, fieldsMap) {\n    this._render = render;\n    this._fields = fields;\n    this._fieldsMap = fieldsMap || {};\n    this._watchMethod = watchMethod;\n  },\n  _renderCore: function (options) {\n    var $container = $(options.container);\n    var dispose = watchChanges(options.model, this._watchMethod, this._fields, this._fieldsMap, function (data) {\n      $container.empty();\n\n      this._render($container, data, options.model);\n    }.bind(this));\n    eventsEngine.on($container, removeEvent, dispose);\n    return $container.contents();\n  }\n});","map":{"version":3,"sources":["C:/Users/abdel/PhpstormProjects/editeur_scenario_jeu/node_modules/devextreme/ui/widget/bindable_template.js"],"names":["$","require","TemplateBase","eventsEngine","removeEvent","iteratorUtils","isPrimitive","watchChanges","start","rawData","watchMethod","fields","fieldsMap","callback","globalDispose","fieldsDispose","globalWatch","dataWithRawFields","fieldsWatch","data","resolvedData","missedFields","slice","watchHandlers","map","name","fieldGetter","value","length","index","indexOf","splice","each","_","dispose","module","exports","inherit","ctor","render","_render","_fields","_fieldsMap","_watchMethod","_renderCore","options","$container","container","model","empty","bind","on","contents"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/widget/bindable_template.js)\r\n * Version: 18.2.13\r\n * Build date: Wed May 27 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar $ = require(\"../../core/renderer\"),\r\n    TemplateBase = require(\"./ui.template_base\"),\r\n    eventsEngine = require(\"../../events/core/events_engine\"),\r\n    removeEvent = require(\"../../core/remove_event\"),\r\n    iteratorUtils = require(\"../../core/utils/iterator\"),\r\n    isPrimitive = require(\"../../core/utils/type\").isPrimitive;\r\nvar watchChanges = function() {\r\n    var start = function(rawData, watchMethod, fields, fieldsMap, callback) {\r\n        var globalDispose, fieldsDispose;\r\n        globalDispose = globalWatch(rawData, watchMethod, function(dataWithRawFields) {\r\n            fieldsDispose && fieldsDispose();\r\n            if (isPrimitive(dataWithRawFields)) {\r\n                callback(dataWithRawFields);\r\n                return\r\n            }\r\n            fieldsDispose = fieldsWatch(dataWithRawFields, watchMethod, fields, fieldsMap, function(data) {\r\n                callback(data)\r\n            })\r\n        });\r\n        return function() {\r\n            fieldsDispose && fieldsDispose();\r\n            globalDispose && globalDispose()\r\n        }\r\n    };\r\n    var globalWatch = function(data, watchMethod, callback) {\r\n        return watchMethod(function() {\r\n            return data\r\n        }, callback)\r\n    };\r\n    var fieldsWatch = function(data, watchMethod, fields, fieldsMap, callback) {\r\n        var resolvedData = {},\r\n            missedFields = fields.slice();\r\n        var watchHandlers = iteratorUtils.map(fields, function(name) {\r\n            var fieldGetter = fieldsMap[name];\r\n            return watchMethod(fieldGetter ? function() {\r\n                return fieldGetter(data)\r\n            } : function() {\r\n                return data[name]\r\n            }, function(value) {\r\n                resolvedData[name] = value;\r\n                if (missedFields.length) {\r\n                    var index = missedFields.indexOf(name);\r\n                    if (index >= 0) {\r\n                        missedFields.splice(index, 1)\r\n                    }\r\n                }\r\n                if (!missedFields.length) {\r\n                    callback(resolvedData)\r\n                }\r\n            })\r\n        });\r\n        return function() {\r\n            iteratorUtils.each(watchHandlers, function(_, dispose) {\r\n                dispose()\r\n            })\r\n        }\r\n    };\r\n    return start\r\n}();\r\nmodule.exports = TemplateBase.inherit({\r\n    ctor: function(render, fields, watchMethod, fieldsMap) {\r\n        this._render = render;\r\n        this._fields = fields;\r\n        this._fieldsMap = fieldsMap || {};\r\n        this._watchMethod = watchMethod\r\n    },\r\n    _renderCore: function(options) {\r\n        var $container = $(options.container);\r\n        var dispose = watchChanges(options.model, this._watchMethod, this._fields, this._fieldsMap, function(data) {\r\n            $container.empty();\r\n            this._render($container, data, options.model)\r\n        }.bind(this));\r\n        eventsEngine.on($container, removeEvent, dispose);\r\n        return $container.contents()\r\n    }\r\n});\r\n"]},"metadata":{},"sourceType":"script"}