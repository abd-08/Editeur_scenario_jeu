{"ast":null,"code":"/**\r\n * DevExtreme (ui/text_box/utils.caret.js)\r\n * Version: 18.2.8\r\n * Build date: Tue Apr 23 2019\r\n *\r\n * Copyright (c) 2012 - 2019 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar $ = require(\"../../core/renderer\"),\n    isDefined = require(\"../../core/utils/type\").isDefined,\n    browser = require(\"../../core/utils/browser\"),\n    domAdapter = require(\"../../core/dom_adapter\");\n\nvar isFocusingOnCaretChange = browser.msie || browser.safari;\n\nvar getCaret = function getCaret(input) {\n  if (isObsoleteBrowser(input)) {\n    return getCaretForObsoleteBrowser(input);\n  }\n\n  return {\n    start: input.selectionStart,\n    end: input.selectionEnd\n  };\n};\n\nvar setCaret = function setCaret(input, position) {\n  if (isObsoleteBrowser(input)) {\n    setCaretForObsoleteBrowser(input, position);\n    return;\n  }\n\n  if (!domAdapter.getBody().contains(input)) {\n    return;\n  }\n\n  input.selectionStart = position.start;\n  input.selectionEnd = position.end;\n};\n\nvar isObsoleteBrowser = function isObsoleteBrowser(input) {\n  return !input.setSelectionRange;\n};\n\nvar getCaretForObsoleteBrowser = function getCaretForObsoleteBrowser(input) {\n  var range = domAdapter.getSelection().createRange();\n  var rangeCopy = range.duplicate();\n  range.move(\"character\", -input.value.length);\n  range.setEndPoint(\"EndToStart\", rangeCopy);\n  return {\n    start: range.text.length,\n    end: range.text.length + rangeCopy.text.length\n  };\n};\n\nvar setCaretForObsoleteBrowser = function setCaretForObsoleteBrowser(input, position) {\n  if (!domAdapter.getBody().contains(input)) {\n    return;\n  }\n\n  var range = input.createTextRange();\n  range.collapse(true);\n  range.moveStart(\"character\", position.start);\n  range.moveEnd(\"character\", position.end - position.start);\n  range.select();\n};\n\nvar caret = function caret(input, position) {\n  input = $(input).get(0);\n\n  if (!isDefined(position)) {\n    return getCaret(input);\n  }\n\n  if (isFocusingOnCaretChange && domAdapter.getActiveElement() !== input) {\n    return;\n  }\n\n  setCaret(input, position);\n};\n\nmodule.exports = caret;","map":null,"metadata":{},"sourceType":"script"}